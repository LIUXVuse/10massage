(()=>{var e={};e.id=14,e.ids=[14],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},5486:e=>{"use strict";e.exports=require("bcrypt")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},11723:e=>{"use strict";e.exports=require("querystring")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},75406:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>h,routeModule:()=>p,serverHooks:()=>w,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>y});var n={};r.r(n),r.d(n,{GET:()=>d,POST:()=>f,dynamic:()=>l});var i=r(42706),a=r(28203),s=r(45994),o=r(51825),u=r.n(o),c=r(9327);let l="force-dynamic";async function d(e,t){let r=await (0,c.t0)();return await u()(r)(e,t)}async function f(e,t){let r=await (0,c.t0)();return await u()(r)(e,t)}let p=new i.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"D:\\projects\\10massage\\src\\app\\api\\auth\\[...nextauth]\\route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:g,workUnitAsyncStorage:y,serverHooks:w}=p;function h(){return(0,s.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:y})}},12834:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"008714a1082823a73660e8ec88a0ade1616b66c8a2":()=>n.t0,"00d3881832f50de8071dd3d12d11daaf7d1a0dc291":()=>n.jb,"00e620fe28ce63ffb62e0165e3a97624d036fc2eff":()=>n.U7,"00fb7d4ef29a91628e91e0334044049dc772c9e749":()=>n.PA,"00fd98bf2c31c2872ceb5c468154c083084cdf50c6":()=>n.Up});var n=r(9327)},96487:()=>{},78335:()=>{},91642:(e,t)=>{"use strict";t.A=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}},56215:(e,t)=>{"use strict";function r(e){for(let t=0;t<e.length;t++){let r=e[t];if("function"!=typeof r)throw Error(`A "use server" file can only export async functions, found ${typeof r}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`)}}Object.defineProperty(t,"D",{enumerable:!0,get:function(){return r}})},88977:(e,t,r)=>{"use strict";Object.defineProperty(t,"A",{enumerable:!0,get:function(){return n.registerServerReference}});let n=r(46760)},54175:(e,t,r)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{arrayBufferToString:function(){return o},decrypt:function(){return l},encrypt:function(){return c},getActionEncryptionKey:function(){return y},getClientReferenceManifestForRsc:function(){return g},getServerModuleMap:function(){return p},setReferenceManifestsSingleton:function(){return f},stringToUint8Array:function(){return u}});let i=r(39212),a=r(62045),s=r(29294);function o(e){let t=new Uint8Array(e),r=t.byteLength;if(r<65535)return String.fromCharCode.apply(null,t);let n="";for(let e=0;e<r;e++)n+=String.fromCharCode(t[e]);return n}function u(e){let t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r}function c(e,t,r){return crypto.subtle.encrypt({name:"AES-GCM",iv:t},e,r)}function l(e,t,r){return crypto.subtle.decrypt({name:"AES-GCM",iv:t},e,r)}let d=Symbol.for("next.server.action-manifests");function f({page:e,clientReferenceManifest:t,serverActionsManifest:r,serverModuleMap:n}){var i;let s=null==(i=globalThis[d])?void 0:i.clientReferenceManifestsPerPage;globalThis[d]={clientReferenceManifestsPerPage:{...s,[(0,a.normalizeAppPath)(e)]:t},serverActionsManifest:r,serverModuleMap:n}}function p(){let e=globalThis[d];if(!e)throw new i.InvariantError("Missing manifest for Server Actions.");return e.serverModuleMap}function g(){let e=globalThis[d];if(!e)throw new i.InvariantError("Missing manifest for Server Actions.");let{clientReferenceManifestsPerPage:t}=e,r=s.workAsyncStorage.getStore();if(!r)return function(e){let t=Object.values(e),r={clientModules:{},edgeRscModuleMapping:{},rscModuleMapping:{}};for(let e of t)r.clientModules={...r.clientModules,...e.clientModules},r.edgeRscModuleMapping={...r.edgeRscModuleMapping,...e.edgeRscModuleMapping},r.rscModuleMapping={...r.rscModuleMapping,...e.rscModuleMapping};return r}(t);let n=t[r.route];if(!n)throw new i.InvariantError(`Missing Client Reference Manifest for ${r.route}.`);return n}async function y(){if(n)return n;let e=globalThis[d];if(!e)throw new i.InvariantError("Missing manifest for Server Actions.");let t=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||e.serverActionsManifest.encryptionKey;if(void 0===t)throw new i.InvariantError("Missing encryption key for Server Actions");return n=await crypto.subtle.importKey("raw",u(atob(t)),"AES-GCM",!0,["encrypt","decrypt"])}},98063:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{decryptActionBoundArgs:function(){return p},encryptActionBoundArgs:function(){return f}}),r(27315);let n=r(46760),i=r(8534),a=r(57212),s=r(54175),o=r(63033),u=new TextEncoder,c=new TextDecoder;async function l(e,t){let r=await (0,s.getActionEncryptionKey)();if(void 0===r)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=atob(t),i=n.slice(0,16),a=n.slice(16),o=c.decode(await (0,s.decrypt)(r,(0,s.stringToUint8Array)(i),(0,s.stringToUint8Array)(a)));if(!o.startsWith(e))throw Error("Invalid Server Action payload: failed to decrypt.");return o.slice(e.length)}async function d(e,t){let r=await (0,s.getActionEncryptionKey)();if(void 0===r)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=new Uint8Array(16);o.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(n));let i=(0,s.arrayBufferToString)(n.buffer),a=await (0,s.encrypt)(r,n,u.encode(e+t));return btoa(i+(0,s.arrayBufferToString)(a))}async function f(e,t){let{clientModules:r}=(0,s.getClientReferenceManifestForRsc)(),i=Error();Error.captureStackTrace(i,f);let u=!1,c=await (0,a.streamToString)((0,n.renderToReadableStream)(t,r,{onError(e){u||(u=!0,i.message=e instanceof Error?e.message:String(e))}}));if(u)throw i;let l=o.workUnitAsyncStorage.getStore();if(!l)return d(e,c);let p=(0,o.getPrerenderResumeDataCache)(l),g=(0,o.getRenderResumeDataCache)(l),y=e+c,w=(null==p?void 0:p.encryptedBoundArgs.get(y))??(null==g?void 0:g.encryptedBoundArgs.get(y));if(w)return w;let h="prerender"===l.type?l.cacheSignal:void 0;null==h||h.beginRead();let m=await d(e,c);return null==h||h.endRead(),null==p||p.encryptedBoundArgs.set(y,m),m}async function p(e,t){let{edgeRscModuleMapping:r,rscModuleMapping:n}=(0,s.getClientReferenceManifestForRsc)(),a=await l(e,await t);return await (0,i.createFromReadableStream)(new ReadableStream({start(e){e.enqueue(u.encode(a)),e.close()}}),{serverConsumerManifest:{moduleLoading:null,moduleMap:n,serverModuleMap:(0,s.getServerModuleMap)()}})}},42706:(e,t,r)=>{"use strict";e.exports=r(44870)},50164:(e,t)=>{"use strict";function r(e){return e.startsWith("/")?e:"/"+e}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ensureLeadingSlash",{enumerable:!0,get:function(){return r}})},62045:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{normalizeAppPath:function(){return a},normalizeRscURL:function(){return s}});let n=r(50164),i=r(18758);function a(e){return(0,n.ensureLeadingSlash)(e.split("/").reduce((e,t,r,n)=>!t||(0,i.isGroupSegment)(t)||"@"===t[0]||("page"===t||"route"===t)&&r===n.length-1?e:e+"/"+t,""))}function s(e){return e.replace(/\.rsc($|\?)/,"$1")}},9327:(e,t,r)=>{"use strict";r.d(t,{t0:()=>u,U7:()=>c,Up:()=>d,jb:()=>l,PA:()=>f});var n=r(88977);r(98063);var i=r(91642);function a(e){let t={};for(let r in e)void 0!==e[r]&&(t[r]=e[r]);return{data:t}}var s=r(74069),o=r(5486);async function u(){var e;return{adapter:(e=s.z,{createUser:({id:t,...r})=>e.user.create(a(r)),getUser:t=>e.user.findUnique({where:{id:t}}),getUserByEmail:t=>e.user.findUnique({where:{email:t}}),async getUserByAccount(t){let r=await e.account.findUnique({where:{provider_providerAccountId:t},select:{user:!0}});return r?.user??null},updateUser:({id:t,...r})=>e.user.update({where:{id:t},...a(r)}),deleteUser:t=>e.user.delete({where:{id:t}}),linkAccount:t=>e.account.create({data:t}),unlinkAccount:t=>e.account.delete({where:{provider_providerAccountId:t}}),async getSessionAndUser(t){let r=await e.session.findUnique({where:{sessionToken:t},include:{user:!0}});if(!r)return null;let{user:n,...i}=r;return{user:n,session:i}},createSession:t=>e.session.create(a(t)),updateSession:t=>e.session.update({where:{sessionToken:t.sessionToken},...a(t)}),deleteSession:t=>e.session.delete({where:{sessionToken:t}}),async createVerificationToken(t){let r=await e.verificationToken.create(a(t));return r.id&&delete r.id,r},async useVerificationToken(t){try{let r=await e.verificationToken.delete({where:{identifier_token:t}});return r.id&&delete r.id,r}catch(e){if("P2025"===e.code)return null;throw e}},getAccount:async(t,r)=>e.account.findFirst({where:{providerAccountId:t,provider:r}}),createAuthenticator:async t=>e.authenticator.create(a(t)),getAuthenticator:async t=>e.authenticator.findUnique({where:{credentialID:t}}),listAuthenticatorsByUserId:async t=>e.authenticator.findMany({where:{userId:t}}),updateAuthenticatorCounter:async(t,r)=>e.authenticator.update({where:{credentialID:t},data:{counter:r}})}),session:{strategy:"jwt"},pages:{signIn:"/login"},providers:[(0,i.A)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"密碼",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let t=await s.z.user.findUnique({where:{email:e.email}});return t&&await (0,o.compare)(e.password,t.password)?{id:t.id,email:t.email||"",name:t.name||"",role:t.role}:null}})],callbacks:{session:async({token:e,session:t})=>(e&&(t.user.id=e.id,t.user.name=e.name||"",t.user.email=e.email||"",t.user.role=e.role),t),jwt:async({token:e,user:t})=>(t&&(e.id=t.id,e.role=t.role),e)}}}async function c(){let{getServerSession:e}=await Promise.resolve().then(r.bind(r,64767)),t=await u(),n=await e(t);return n?.user}async function l(){let e=await c();if(!e){let{redirect:e}=await r.e(831).then(r.bind(r,31831));e("/login")}return e}async function d(){let e=await l();if(e.role?.toUpperCase()!=="ADMIN"){let{redirect:e}=await r.e(831).then(r.bind(r,31831));e("/")}return e}async function f(){let e=await l(),t=e.role?.toUpperCase();if("ADMIN"!==t&&"MASSEUR"!==t){let{redirect:e}=await r.e(831).then(r.bind(r,31831));e("/")}return e}(0,r(56215).D)([u,c,l,d,f]),(0,n.A)(u,"008714a1082823a73660e8ec88a0ade1616b66c8a2",null),(0,n.A)(c,"00e620fe28ce63ffb62e0165e3a97624d036fc2eff",null),(0,n.A)(l,"00d3881832f50de8071dd3d12d11daaf7d1a0dc291",null),(0,n.A)(d,"00fd98bf2c31c2872ceb5c468154c083084cdf50c6",null),(0,n.A)(f,"00fb7d4ef29a91628e91e0334044049dc772c9e749",null)},74069:(e,t,r)=>{"use strict";r.d(t,{z:()=>i});var n=r(96330);let i=global.prisma||new n.PrismaClient({log:["error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[638,154,851,825],()=>r(75406));module.exports=n})();