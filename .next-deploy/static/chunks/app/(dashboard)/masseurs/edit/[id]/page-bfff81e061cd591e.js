(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{268:(e,t,r)=>{Promise.resolve().then(r.bind(r,5585))},5585:(e,t,r)=>{"use strict";r.d(t,{MasseurEditClient:()=>q});var o=r(5155),s=r(2115),i=r(6046),a=r(9606),l=r(2679),n=r(3415),c=r(3312),d=r(3900),u=r(5565),p=r(3301),m=r(1567);let h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,o.jsxs)(p.bL,{ref:t,className:(0,m.cn)("relative flex w-full touch-none select-none items-center",r),...s,children:[(0,o.jsx)(p.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,o.jsx)(p.Q6,{className:"absolute h-full bg-primary"})}),(0,o.jsx)(p.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});h.displayName=p.bL.displayName;var f=r(2317),g=r(8986);let x=a.Op,v=s.createContext({}),b=e=>{let{...t}=e;return(0,o.jsx)(v.Provider,{value:{name:t.name},children:(0,o.jsx)(a.xI,{...t})})},j=()=>{let e=s.useContext(v),t=s.useContext(w),{getFieldState:r,formState:o}=(0,a.xW)(),i=r(e.name,o);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=t;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...i}},w=s.createContext({}),y=s.forwardRef((e,t)=>{let{className:r,...i}=e,a=s.useId();return(0,o.jsx)(w.Provider,{value:{id:a},children:(0,o.jsx)("div",{ref:t,className:(0,m.cn)("space-y-2",r),...i})})});y.displayName="FormItem";let N=s.forwardRef((e,t)=>{let{className:r,...s}=e,{error:i,formItemId:a}=j();return(0,o.jsx)(g.J,{ref:t,className:(0,m.cn)(i&&"text-destructive",r),htmlFor:a,...s})});N.displayName="FormLabel";let S=s.forwardRef((e,t)=>{let{...r}=e,{error:s,formItemId:i,formDescriptionId:a,formMessageId:l}=j();return(0,o.jsx)(f.DX,{ref:t,id:i,"aria-describedby":s?"".concat(a," ").concat(l):"".concat(a),"aria-invalid":!!s,...r})});S.displayName="FormControl",s.forwardRef((e,t)=>{let{className:r,...s}=e,{formDescriptionId:i}=j();return(0,o.jsx)("p",{ref:t,id:i,className:(0,m.cn)("text-sm text-muted-foreground",r),...s})}).displayName="FormDescription";let X=s.forwardRef((e,t)=>{let{className:r,children:s,...i}=e,{error:a,formMessageId:l}=j(),n=a?String(null==a?void 0:a.message):s;return n?(0,o.jsx)("p",{ref:t,id:l,className:(0,m.cn)("text-sm font-medium text-destructive",r),...i,children:n}):null});X.displayName="FormMessage";var Y=r(6754),T=r(5754),A=r(6235),k=r(2852),E=r(7953),D=r(6694),W=r(3025),V=r(2783),H=r(8811);let R=H.Kq,U=H.bL,C=H.l9,I=s.forwardRef((e,t)=>{let{className:r,sideOffset:s=4,...i}=e;return(0,o.jsx)(H.UC,{ref:t,sideOffset:s,className:(0,m.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...i})});I.displayName=H.UC.displayName;let O=n.Ik({name:n.Yj().min(1,"請輸入按摩師姓名"),description:n.Yj().max(150,"描述最多允許150個字").optional(),imageUrl:n.Yj().optional(),imageScale:n.ai().optional(),cropX:n.ai().optional(),cropY:n.ai().optional(),cropWidth:n.ai().optional(),cropHeight:n.ai().optional()});function M(e){let{initialData:t,services:r=[],onSubmit:n,onCancel:p}=e,m=(0,i.useRouter)(),[f,g]=(0,s.useState)(!1),[v,j]=(0,s.useState)((null==t?void 0:t.imageUrl)||null),[w,H]=(0,s.useState)((null==t?void 0:t.imageScale)||1),[M,P]=(0,s.useState)({x:(null==t?void 0:t.cropX)||0,y:(null==t?void 0:t.cropY)||0,width:(null==t?void 0:t.cropWidth)||300,height:(null==t?void 0:t.cropHeight)||225}),[z,_]=(0,s.useState)("view"),[F,L]=(0,s.useState)(!1),[$,q]=(0,s.useState)(null),[J,G]=(0,s.useState)({x:0,y:0}),[B,Q]=(0,s.useState)(!1),[K,Z]=(0,s.useState)(!1),ee=(0,s.useRef)(null),et=(0,s.useRef)(null),er=(0,s.useRef)(null),eo=(0,s.useRef)(null),es=(0,s.useRef)(null),ei=(0,a.mN)({resolver:(0,l.u)(O),defaultValues:t||{name:"",description:"",imageUrl:"",imageScale:1}});ei.watch(),(0,s.useEffect)(()=>{t&&(ei.setValue("name",t.name),ei.setValue("description",t.description||""),ei.setValue("imageUrl",t.imageUrl||""),t.imageScale&&(H(t.imageScale),ei.setValue("imageScale",t.imageScale)),void 0!==t.cropX&&void 0!==t.cropY&&void 0!==t.cropWidth&&void 0!==t.cropHeight?(P({x:t.cropX,y:t.cropY,width:t.cropWidth,height:t.cropHeight}),ei.setValue("cropX",t.cropX),ei.setValue("cropY",t.cropY),ei.setValue("cropWidth",t.cropWidth),ei.setValue("cropHeight",t.cropHeight),_("view")):null!=t.imageScale&&_("view"),j(t.imageUrl||null))},[t,ei]);let ea=async e=>{if(!e)return;j(URL.createObjectURL(e)),H(1),P({x:0,y:0,width:300,height:225}),_("view"),Z(!1);let t=new FormData;t.append("file",e);try{let e=await fetch("/api/upload",{method:"POST",body:t});if(!e.ok)throw Error("上傳圖片失敗");let{url:r}=await e.json();ei.setValue("imageUrl",r,{shouldValidate:!0})}catch(e){console.error("上傳圖片時發生錯誤:",e),j(null)}},el=async e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&await ea(r)},en=e=>{e.preventDefault(),e.stopPropagation(),Q(!0)},ec=e=>{e.preventDefault(),e.stopPropagation(),Q(!1)},ed=async e=>{e.preventDefault(),e.stopPropagation(),Q(!1);let t=e.dataTransfer.files;if(t.length>0){let e=t[0];e.type.startsWith("image/")&&await ea(e)}},eu=e=>{H(e[0]),ei.setValue("imageScale",e[0])},ep=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;"crop"===z&&(e.stopPropagation(),L(!0),q(t),G({x:e.clientX,y:e.clientY}))},em=e=>{if(!F||"crop"!==z)return;e.preventDefault();let t=e.clientX-J.x,r=e.clientY-J.y;if($){let e={...M};switch($){case"topLeft":e.x+=t,e.y+=r,e.width-=t,e.height-=r;break;case"topRight":e.y+=r,e.width+=t,e.height-=r;break;case"bottomLeft":e.x+=t,e.width-=t,e.height+=r;break;case"bottomRight":e.width+=t,e.height+=r}e.width>=50&&e.height>=50&&(P(e),ei.setValue("cropX",e.x),ei.setValue("cropY",e.y),ei.setValue("cropWidth",e.width),ei.setValue("cropHeight",e.height))}else{let e={...M,x:M.x+t,y:M.y+r};P(e),ei.setValue("cropX",e.x),ei.setValue("cropY",e.y)}G({x:e.clientX,y:e.clientY})},eh=()=>{L(!1),q(null)},ef=e=>{if("crop"!==z||1!==e.touches.length)return;e.preventDefault();let t=e.touches[0];L(!0),G({x:t.clientX,y:t.clientY})},eg=e=>{if(!F||"crop"!==z||1!==e.touches.length)return;let t=e.touches[0];em({clientX:t.clientX,clientY:t.clientY})},ex=()=>{L(!1)},ev=()=>{console.log("重置功能被觸發: 目前模式",z),"scale"===z?(H(1),ei.setValue("imageScale",1)):"crop"===z&&(P({x:0,y:0,width:300,height:225}),ei.setValue("cropX",0),ei.setValue("cropY",0),ei.setValue("cropWidth",300),ei.setValue("cropHeight",225),ei.trigger(["cropX","cropY","cropWidth","cropHeight"])),console.log("重置完成: 新設定",{editMode:z,imageScale:"scale"===z?1:w,cropBox:"crop"===z?{x:0,y:0,width:300,height:225}:M})},eb=async e=>{try{g(!0);let r={...e};if("crop"===z?(console.log("裁切模式提交表單 - 使用當前裁切框設定:",M),r.cropX=M.x,r.cropY=M.y,r.cropWidth=M.width,r.cropHeight=M.height,r.imageScale=1):"scale"===z?(console.log("縮放模式提交表單 - 使用當前縮放設定:",w),r.imageScale=w,(null==t?void 0:t.cropX)!==void 0&&(null==t?void 0:t.cropY)!==void 0?(r.cropX=t.cropX,r.cropY=t.cropY,r.cropWidth=t.cropWidth,r.cropHeight=t.cropHeight):(r.cropX=0,r.cropY=0,r.cropWidth=void 0,r.cropHeight=void 0)):(console.log("檢視模式提交表單 - 使用原始設定"),t?(r.imageScale=t.imageScale||1,r.cropX=t.cropX,r.cropY=t.cropY,r.cropWidth=t.cropWidth,r.cropHeight=t.cropHeight):(r.imageScale=1,r.cropX=0,r.cropY=0)),!r.imageUrl&&(null==t?void 0:t.imageUrl)&&(r.imageUrl=t.imageUrl),console.log("準備提交表單數據:",{editMode:z,imageScale:r.imageScale,cropX:r.cropX,cropY:r.cropY,cropWidth:r.cropWidth,cropHeight:r.cropHeight,imageUrl:r.imageUrl}),n){await n(r);return}let o=(null==t?void 0:t.id)?"/api/masseurs/".concat(t.id):"/api/masseurs",s=(null==t?void 0:t.id)?"PUT":"POST";console.log("發送 ".concat(s," 請求到 ").concat(o));let i=await fetch(o,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),a=await i.json();if(console.log("API 響應:",a),!i.ok)throw Error(a.error||"提交失敗");m.push("/masseurs"),m.refresh()}catch(e){console.error("提交表單時發生錯誤:",e),alert("提交失敗，請稍後再試")}finally{g(!1)}};return(0,o.jsx)(x,{...ei,children:(0,o.jsxs)("form",{onSubmit:ei.handleSubmit(eb),className:"space-y-8",children:[(0,o.jsx)(b,{control:ei.control,name:"name",render:e=>{let{field:t}=e;return(0,o.jsxs)(y,{children:[(0,o.jsx)(N,{children:"名稱"}),(0,o.jsx)(S,{children:(0,o.jsx)(d.p,{placeholder:"請輸入按摩師名稱",...t})}),(0,o.jsx)(X,{})]})}}),(0,o.jsx)(b,{control:ei.control,name:"description",render:e=>{let{field:t}=e;return(0,o.jsxs)(y,{children:[(0,o.jsx)(N,{children:"描述 (選填，最多150字)"}),(0,o.jsx)(S,{children:(0,o.jsx)(Y.T,{placeholder:"請輸入按摩師描述（選填）",className:"resize-none",...t})}),(0,o.jsx)(X,{})]})}}),(0,o.jsx)(b,{control:ei.control,name:"imageUrl",render:e=>{let{field:t}=e;return(0,o.jsxs)(y,{children:[(0,o.jsx)(N,{children:"按摩師照片"}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)(S,{children:(0,o.jsx)(d.p,{placeholder:"請輸入圖片網址",...t})}),(0,o.jsx)(c.$,{type:"button",variant:"outline",onClick:()=>{var e;return null===(e=ee.current)||void 0===e?void 0:e.click()},children:"上傳圖片"}),(0,o.jsx)("input",{type:"file",ref:ee,className:"hidden",accept:"image/*",onChange:el})]}),(0,o.jsx)(X,{}),!v&&(0,o.jsxs)("div",{ref:es,className:"border-2 border-dashed rounded-lg p-8 transition-colors\n                      ".concat(B?"border-primary bg-primary/5":"border-gray-300 hover:border-primary/50","\n                      flex flex-col items-center justify-center text-center cursor-pointer"),onClick:()=>{var e;return null===(e=ee.current)||void 0===e?void 0:e.click()},onDragOver:en,onDragLeave:ec,onDrop:ed,children:[(0,o.jsx)(T.A,{className:"h-12 w-12 text-gray-400 mb-3"}),(0,o.jsx)("p",{className:"text-sm font-medium mb-1",children:"將圖片拖曳至此處"}),(0,o.jsx)("p",{className:"text-xs text-gray-500",children:"支援 JPG, PNG, GIF 等常見圖片格式"})]}),(v||t.value)&&(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,o.jsxs)(c.$,{type:"button",variant:"view"===z?"default":"outline",size:"sm",onClick:()=>_("view"),children:[(0,o.jsx)(A.A,{className:"h-4 w-4 mr-1"})," 預覽"]}),(0,o.jsxs)(c.$,{type:"button",variant:"scale"===z?"default":"outline",size:"sm",onClick:()=>_("scale"),children:[(0,o.jsx)(k.A,{className:"h-4 w-4 mr-1"})," 縮放"]}),(0,o.jsxs)(c.$,{type:"button",variant:"crop"===z?"default":"outline",size:"sm",onClick:()=>_("crop"),children:[(0,o.jsx)(E.A,{className:"h-4 w-4 mr-1"})," 裁切"]})]}),"view"!==z&&(0,o.jsx)(R,{children:(0,o.jsxs)(U,{children:[(0,o.jsx)(C,{asChild:!0,children:(0,o.jsx)(c.$,{type:"button",variant:"outline",size:"icon",onClick:ev,children:(0,o.jsx)(D.A,{className:"h-4 w-4"})})}),(0,o.jsx)(I,{children:(0,o.jsx)("p",{children:"crop"===z?"重置裁剪框":"重置縮放"})})]})})]}),"scale"===z&&(0,o.jsxs)("div",{className:"flex items-center space-x-4 pl-2 pr-2",children:[(0,o.jsx)(W.A,{className:"h-4 w-4 text-gray-500"}),(0,o.jsx)(h,{defaultValue:[w],min:.5,max:2,step:.1,onValueChange:eu,value:[w]}),(0,o.jsx)(k.A,{className:"h-4 w-4 text-gray-500"})]}),(0,o.jsxs)("div",{ref:et,className:"relative w-full aspect-[4/3] border rounded-lg overflow-hidden bg-gray-50",onMouseMove:em,onMouseUp:eh,onMouseLeave:eh,onTouchStart:ef,onTouchMove:eg,onTouchEnd:ex,children:[(0,o.jsx)("div",{ref:er,className:"absolute w-full h-full",children:(0,o.jsx)(u.default,{src:v||t.value||"",alt:"按摩師照片預覽",fill:!0,className:"object-contain",style:{transform:"scale"===z?"scale(".concat(w,")"):void 0,objectFit:"contain"},sizes:"(max-width: 768px) 100vw, 500px",onLoad:e=>{Z(!0),console.log("表單圖片載入完成",{naturalWidth:e.target.naturalWidth,naturalHeight:e.target.naturalHeight,imageUrl:v||t.value})},onError:e=>{console.error("表單圖片載入錯誤",{error:e,imageUrl:v||t.value})}})}),"crop"===z&&(0,o.jsxs)("div",{ref:eo,className:"absolute border-2 border-white box-content",style:{left:"".concat(M.x,"px"),top:"".concat(M.y,"px"),width:"".concat(M.width,"px"),height:"".concat(M.height,"px"),boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.5)",cursor:"move"},onMouseDown:e=>ep(e),children:[(0,o.jsx)("div",{className:"absolute w-6 h-6 bg-white rounded-full border-2 border-primary -left-3 -top-3 cursor-nw-resize",onMouseDown:e=>ep(e,"topLeft")}),(0,o.jsx)("div",{className:"absolute w-6 h-6 bg-white rounded-full border-2 border-primary -right-3 -top-3 cursor-ne-resize",onMouseDown:e=>ep(e,"topRight")}),(0,o.jsx)("div",{className:"absolute w-6 h-6 bg-white rounded-full border-2 border-primary -left-3 -bottom-3 cursor-sw-resize",onMouseDown:e=>ep(e,"bottomLeft")}),(0,o.jsx)("div",{className:"absolute w-6 h-6 bg-white rounded-full border-2 border-primary -right-3 -bottom-3 cursor-se-resize",onMouseDown:e=>ep(e,"bottomRight")})]})]}),(0,o.jsxs)("div",{className:"text-sm text-gray-500 italic",children:["view"===z&&(0,o.jsx)("p",{children:"預覽模式：查看照片的最終效果"}),"scale"===z&&(0,o.jsx)("p",{children:"縮放模式：調整照片的縮放比例"}),"crop"===z&&(0,o.jsx)("p",{children:"裁切模式：拖動邊框或角落調整裁切區域"})]})]})]})]})}}),(0,o.jsxs)("div",{className:"flex justify-end space-x-4 pt-4",children:[p&&(0,o.jsx)(c.$,{type:"button",variant:"outline",onClick:p,children:"取消"}),(0,o.jsxs)(c.$,{type:"submit",disabled:f,children:[f&&(0,o.jsx)(V.A,{className:"mr-2 h-4 w-4 animate-spin"}),t?"更新按摩師":"添加按摩師"]})]})]})})}var P=r(1598),z=r(2615),_=r(8173),F=r.n(_),L=r(5088),$=r(8291);function q(e){let{id:t}=e,{data:r,status:a}=(0,z.useSession)(),l=(0,i.useRouter)(),[n,d]=(0,s.useState)(null),[u,p]=(0,s.useState)([]),[m,h]=(0,s.useState)(!0),[f,g]=(0,s.useState)(!1),[x,v]=(0,s.useState)(null),b="new"===t;(0,s.useEffect)(()=>{var e;console.log("Session data:",r),console.log("User role:",null==r?void 0:null===(e=r.user)||void 0===e?void 0:e.role),console.log("IsAdmin result:",(0,$.q)(r))},[r]),(0,s.useEffect)(()=>{"unauthenticated"===a?l.push("/login"):"authenticated"!==a||(0,$.q)(r)||(l.push("/dashboard"),(0,L.o)({title:"權限不足",description:"只有管理員能夠編輯按摩師資料",variant:"destructive"}))},[r,a,l]),(0,s.useEffect)(()=>{let e=async()=>{h(!0);try{let e=await fetch("/api/services");if(!e.ok)throw Error("無法獲取服務列表");let r=await e.json();if(p(r),b)h(!1);else{let e=await fetch("/api/masseurs/".concat(t));if(!e.ok)throw Error("無法獲取按摩師數據");let r=await e.json();console.log("編輯頁面獲取到的按摩師數據:",r);let o={...r,cropX:void 0!==r.cropX?r.cropX:0,cropY:void 0!==r.cropY?r.cropY:0,cropWidth:void 0!==r.cropWidth?r.cropWidth:300,cropHeight:void 0!==r.cropHeight?r.cropHeight:225,imageScale:void 0!==r.imageScale?r.imageScale:1};d(o)}}catch(e){v(e instanceof Error?e.message:"獲取數據時發生錯誤"),(0,L.o)({title:"載入失敗",description:e instanceof Error?e.message:"獲取數據時發生錯誤",variant:"destructive"})}finally{h(!1)}};"authenticated"===a&&(0,$.q)(r)&&e()},[t,r,a,b]);let j=async e=>{g(!0);try{let r="new"===t,o=r?"POST":"PUT",s="/api/masseurs";console.log("提交表單數據",{isNewMasseur:r,method:o,data:{...e,id:r?void 0:t,imageScale:e.imageScale,cropX:e.cropX,cropY:e.cropY,cropWidth:e.cropWidth,cropHeight:e.cropHeight}});let i={...e,id:r?void 0:t};void 0!==e.imageScale&&(i.imageScale=Number(e.imageScale)),void 0!==e.cropX&&(i.cropX=Number(e.cropX)),void 0!==e.cropY&&(i.cropY=Number(e.cropY)),void 0!==e.cropWidth&&(i.cropWidth=Number(e.cropWidth)),void 0!==e.cropHeight&&(i.cropHeight=Number(e.cropHeight)),console.log("發送API請求",{method:o,url:s,data:i});let a=await fetch(s,{method:o,headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),l=await a.json();if(console.log("API回應",l),!a.ok)throw Error(l.error||"".concat(r?"新增":"更新","按摩師失敗 (").concat(a.status,")"));(0,L.o)({title:"成功",description:"按摩師已成功".concat(r?"新增":"更新")}),window.location.href="/masseurs"}catch(e){console.error("提交表單時發生錯誤:",e),(0,L.o)({title:"錯誤",description:e.message||"".concat(b?"新增":"更新","按摩師失敗"),variant:"destructive"})}finally{g(!1)}};return"loading"===a||m&&!b?(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[(0,o.jsx)(V.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,o.jsx)("p",{className:"mt-4 text-lg text-gray-600",children:"載入中..."})]}):x&&!b?(0,o.jsxs)("div",{className:"p-6",children:[(0,o.jsx)("div",{className:"mb-4",children:(0,o.jsx)(F(),{href:"/masseurs",children:(0,o.jsxs)(c.$,{variant:"outline",size:"sm",children:[(0,o.jsx)(P.A,{className:"mr-2 h-4 w-4"}),"返回按摩師列表"]})})}),(0,o.jsxs)("div",{className:"bg-red-50 border border-red-200 p-4 rounded-md",children:[(0,o.jsx)("h2",{className:"text-lg font-medium text-red-800 mb-2",children:"載入失敗"}),(0,o.jsx)("p",{className:"text-red-700",children:x})]})]}):(0,o.jsxs)("div",{className:"p-6",children:[(0,o.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(F(),{href:"/masseurs",children:(0,o.jsxs)(c.$,{variant:"outline",size:"sm",children:[(0,o.jsx)(P.A,{className:"mr-2 h-4 w-4"}),"返回按摩師列表"]})}),(0,o.jsx)("h1",{className:"text-2xl font-bold ml-4",children:b?"新增按摩師":"編輯按摩師資料"})]})}),(0,o.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,o.jsx)(M,{initialData:b?void 0:n||void 0,services:u,onSubmit:j,onCancel:()=>l.push("/masseurs")}),f&&(0,o.jsxs)("div",{className:"flex items-center justify-center mt-4",children:[(0,o.jsx)(V.A,{className:"mr-2 h-4 w-4 animate-spin"}),(0,o.jsxs)("span",{children:["正在",b?"新增":"儲存","..."]})]})]})]})}},3312:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var o=r(5155),s=r(2115),i=r(2317),a=r(1027),l=r(1567);let n=(0,a.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:a,asChild:c=!1,...d}=e,u=c?i.DX:"button";return(0,o.jsx)(u,{className:(0,l.cn)(n({variant:s,size:a,className:r})),ref:t,...d})});c.displayName="Button"},3900:(e,t,r)=>{"use strict";r.d(t,{p:()=>a});var o=r(5155),s=r(2115),i=r(1567);let a=s.forwardRef((e,t)=>{let{className:r,type:s,...a}=e;return(0,o.jsx)("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});a.displayName="Input"},8986:(e,t,r)=>{"use strict";r.d(t,{J:()=>c});var o=r(5155),s=r(2115),i=r(6195),a=r(1027),l=r(1567);let n=(0,a.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,o.jsx)(i.b,{ref:t,className:(0,l.cn)(n(),r),...s})});c.displayName=i.b.displayName},6754:(e,t,r)=>{"use strict";r.d(t,{T:()=>a});var o=r(5155),s=r(2115),i=r(1567);let a=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,o.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...s})});a.displayName="Textarea"},5088:(e,t,r)=>{"use strict";r.d(t,{d:()=>p,o:()=>u});var o=r(2115);let s=0,i=new Map,a=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?d(r):e.toasts.forEach(e=>{d(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],n={toasts:[]};function c(e){n=a(n,e),l.forEach(e=>{e(n)})}function d(e){if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)}function u(e){let{variant:t="default",title:r,description:o,duration:i=5e3,action:a}=e,l=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString();return c({type:"ADD_TOAST",toast:{id:l,title:r,description:o,variant:t,duration:i,action:a}}),{id:l,dismiss:()=>c({type:"DISMISS_TOAST",toastId:l}),update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:l}})}}function p(){let[e,t]=o.useState(n);return o.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},8291:(e,t,r)=>{"use strict";function o(e){var t,r;return(null==e?void 0:null===(r=e.user)||void 0===r?void 0:null===(t=r.role)||void 0===t?void 0:t.toUpperCase())==="ADMIN"}r.d(t,{q:()=>o})},1567:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var o=r(3463),s=r(9795);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,o.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[374,615,130,40,635,256,16,441,517,358],()=>t(268)),_N_E=e.O()}]);